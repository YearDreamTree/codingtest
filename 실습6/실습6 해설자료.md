# 실습6 해설자료

## ✅ 핵심 개념 정리 (Python)

이 문제를 해결하기 위해 사용할 수 있는 파이썬의 주요 기능은 다음과 같음.

| 개념                 | 설명                                                                                 |
| -------------------- | ------------------------------------------------------------------------------------ |
| **파일 처리** | `with open()`: 파일을 열고 자동으로 닫음. `for line in file`: 파일 내용을 한 줄씩 읽음. |
| **문자열 메소드** | `.strip()`: 양 끝 공백/줄바꿈 제거. `.split('/')`: '/' 기준 분리. `.startswith()`: 시작 확인. |
| **튜플 언패킹** | `a, b = 리스트/튜플`: 시퀀스 요소를 여러 변수에 나눠 할당함.                                |
| **타입 변환** | `int()`: 문자열을 정수로 변환함 (빈도수 정렬 위해 필수).                               |
| **자료 구조** | 리스트 `[]`: 데이터 모음 저장. 튜플 `()`: (단어, 빈도수) 묶음 저장.                  |
| **리스트 컴프리헨션** | `[결과 for 항목 in 리스트 if 조건]`: 조건 필터링 및 새 리스트 생성에 간결함.            |
| **`sorted()` 함수** | `sorted(리스트, key=함수, reverse=True)`: 정렬된 새 리스트 반환. `key`, `reverse`로 정렬 방식 지정. |
| **함수 (헬퍼/lambda)**| `get_freq(pair)` 또는 `lambda x: x[1]`: `sorted`의 `key` 인자로 사용되어 정렬 기준 제공. |
| **리스트 슬라이싱** | `[:20]`: 리스트의 처음부터 20개 요소 선택.                                            |
| **`print()` 함수** | 결과를 화면에 출력함 (문제 요구사항).                                                     |

---

## ✅ 문제 해결 아이디어

**최종 목표**: `corpus.txt` 파일에서 `text`로 시작하는 단어를 찾아 빈도순 상위 20개를 `(단어, 빈도수)` 튜플 리스트로 출력함.

**단계별 생각**:

1.  **데이터 읽고 준비**: 먼저 파일(`corpus.txt`)을 읽어야 함. 각 줄은 "단어/빈도수" 형태이므로, 읽으면서 바로 단어와 빈도수를 분리하고, 빈도수는 숫자로 변환해야 함. 이 `(단어, 숫자_빈도수)` 쌍을 어딘가에 모아둬야 함. 리스트(`corpus`)에 튜플 형태로 저장하는 것이 좋겠음.
2.  **필요한 데이터만 선택 (필터링)**: 전체 데이터(`corpus`) 중, 단어가 입력받은 `text`로 시작하는 것만 필요함. `corpus` 리스트를 돌면서 조건을 확인하고, 만족하는 튜플만 모아 새 리스트(`result`)를 만들어야 함.
3.  **원하는 순서로 정렬**: 필터링된 `result` 리스트를 '빈도수'가 높은 순서(내림차순)로 정렬해야 함.
4.  **최종 결과 출력**: 정렬된 결과에서 상위 20개만 선택하여 화면에 `print`해야 함.

---

## ✅ 단계별 구현 과정 상세 설명

위 생각의 흐름에 따라 함수 `filter_by_text(text)`를 구현함.

### (1단계) 파일 읽기 및 데이터 저장 (`corpus` 리스트 만들기)

-   파일을 다루기 위해 `with open("corpus.txt") as file:` 구문을 사용하는 것이 표준적이고 안전함. (인코딩 명시는 실제 환경에 따라 필요할 수 있으나, 여기서는 정답 코드에 맞춰 생략함).
-   파일을 한 줄씩 읽기 위해 `for line in file:` 반복문을 사용함.
-   각 `line`을 처리하는 가장 간결한 방법은 다음과 같음:
    -   `line.strip()`: 줄 끝의 `\n` 등 제거.
    -   `.split('/')`: '/' 기준으로 분리하여 `['단어', '빈도수_문자열']` 생성.
    -   `word, freq_str = ...`: 튜플 언패킹으로 결과를 각 변수에 할당.
    -   `int(freq_str)`: 빈도수를 정수로 변환.
    -   이 모든 것을 조합하여 `corpus` 리스트에 `(단어, 정수_빈도수)` 튜플을 추가함.

```python
# 함수 시작, corpus 리스트 초기화
corpus = []
# 파일 열기 (with 구문 활용)
with open("corpus.txt") as file:
    # 한 줄씩 읽기
    for line in file:
        # 파싱 및 타입 변환, 튜플 생성 후 리스트에 추가하는 과정을 한 줄로 표현 가능
        # (단, 파일 형식 오류나 int 변환 오류 발생 시 에러 가능성은 있음)
        word, freq_str = line.strip().split('/')
        corpus.append((word, int(freq_str)))
# 이 지점에서 corpus 리스트 완성됨
```

### (2단계) 조건 필터링 (`result` 리스트 만들기)

-   `corpus` 리스트에서 `text`로 시작하는 단어를 가진 튜플만 걸러내야 함.
-   `for` 루프와 `if` 문을 사용할 수도 있지만, 리스트 컴프리헨션이 더 간결함. 정답 코드에서 이 방식을 사용했으므로 이를 구현함.

```python
# 리스트 컴프리헨션: corpus의 각 튜플 (word, freq)에 대해
# word가 text로 시작하는 경우만 해당 (word, freq) 튜플을 result 리스트에 포함시킴
result = [(word, freq) for word, freq in corpus if word.startswith(text)]
```
-   `for word, freq in corpus` 부분은 `corpus`의 각 튜플을 순회하며 내부 요소를 `word`, `freq`로 언패킹함.
-   `if word.startswith(text)` 부분에서 조건을 검사함.

### (3단계) 빈도수 기준 내림차순 정렬 및 상위 20개 출력

-   필터링된 `result` 리스트를 정렬하고, 상위 20개를 선택하고, 출력해야 함. 이 세 가지 작업을 한 줄의 코드로 처리하는 것이 정답 코드의 방식임.
-   `sorted()` 함수 사용: 정렬된 새 리스트를 반환함.
    -   `key=get_freq`: 정렬 기준을 `get_freq` 함수(튜플의 두 번째 요소, 즉 빈도수 반환)로 지정함. (또는 `lambda x: x[1]` 사용 가능).
    -   `reverse=True`: 내림차순으로 정렬함.
-   `[:20]` 슬라이싱: `sorted()`가 반환한 정렬된 리스트에서 앞 20개 요소를 선택함.
-   `print()`: 최종 결과를 화면에 출력함.

```python
# 정렬(sorted), 슬라이싱([:20]), 출력(print)을 한 줄에 실행
print(sorted(result, key=get_freq, reverse=True)[:20])
```

---

## ✅ 전체 코드 조합

위 단계들을 조합하여 `filter_by_text` 함수를 완성하면 정확히 정답 코드와 같아짐.

```python
# 단어와 빈도수의 쌍으로 이루어진 튜플을 받아, 빈도수를 리턴합니다.
# (정렬 key로 사용하기 위한 헬퍼 함수)
def get_freq(pair):
    return pair[1]

def filter_by_text(text) :
    # 1단계: 데이터 읽기 및 준비
    corpus = []
    with open("corpus.txt") as file:
        for line in file:
            # 파싱, 변환, 저장을 간결하게 처리 (오류 가능성은 내포)
            word, freq_str = line.strip().split('/')
            corpus.append((word, int(freq_str)))

    # 2단계: 조건 필터링 (리스트 컴프리헨션)
    result = [(word, freq) for word, freq in corpus if word.startswith(text)]

    # 3, 4단계: 정렬, 상위 20개 선택, 출력 (한 줄 처리)
    print(sorted(result, key=get_freq, reverse=True)[:20])

# (이하 테스트 코드)
# t = input()
# filter_by_text(t)
```

---

## 🧾 입출력 예시 설명

(이전 해설 자료와 내용 동일 - 입력 'a'가 주어졌을 때, 위 코드가 어떻게 단계별로 실행되어 최종 결과 리스트 `[('and', 2682878), ...]` 를 출력하는지 설명)

---

## ❗ 자주 하는 실수

| 실수 내용                     | 설명                                                                          |
| ----------------------------- | ----------------------------------------------------------------------------- |
| 파일 처리 오류                | 경로/이름 오류, 파일 미닫음 (`with open` 사용으로 해결됨). (인코딩 문제는 여전히 가능) |
| 데이터 파싱/변환 오류         | 파일 형식이 다르거나 빈도수가 숫자가 아닐 때 에러 발생 가능 (현재 코드는 처리 안함). |
| 필터링 조건 오류              | `startswith()` 대신 `in` 사용 등 조건 로직 오류                                |
| 정렬 오류                     | `key` 미지정/오지정 (`get_freq`), `reverse=True` 누락, `sorted()`/`.sort()` 혼동 |
| 슬라이싱/출력 오류            | `[:20]` 누락, `print` 대신 `return` 사용 (문제 요구사항 위반)                 |
| 타입 오류 (정수 변환 관련)    | `int()` 변환 전에 비교/정렬 시도 시 논리 오류 발생 (현재 코드는 변환 후 처리). |
| 튜플 언패킹 오류              | `split()` 결과 개수와 언패킹 변수 개수 불일치 시 `ValueError` 발생 가능성   |

---

## ✅ 이 문제로 배우는 것

- 텍스트 파일에서 구조화된 데이터를 읽고 파싱하여 파이썬 자료구조(리스트, 튜플)로 변환하는 과정을 연습함.
- `.strip()`, `.split()`, `int()`, 튜플 언패킹 등 기본적인 데이터 가공 기술을 적용함.
- 리스트 컴프리헨션을 활용하여 조건에 맞는 데이터를 효율적으로 필터링하는 방법을 익힘.
- `sorted()` 함수와 `key` 인자(헬퍼 함수 또는 `lambda`)를 이용하여 복합 데이터(튜플)를 특정 기준에 따라 정렬하는 방법을 배움.
- 리스트 슬라이싱으로 원하는 개수만큼의 데이터를 선택하고 `print` 함수로 결과를 출력하는 방법을 확인함.
- (추가) 실제 데이터 처리 시에는 발생할 수 있는 다양한 오류(파일 부재, 형식 오류 등)에 대한 예외 처리의 중요성을 인지할 수 있음.